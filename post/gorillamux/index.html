<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <title>
    Gorilla mux - Issue with order of routes // Parthenon
  </title>

  <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="content-type" content="text/html; charset=utf-8">


<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="">

  <meta property="og:title" content="Gorilla mux - Issue with order of routes" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="http://jijeshmohan.github.io/post/gorillamux/" />


  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/base-min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/pure-min.css">
  
  
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/grids-responsive-min.css">
  
  

  <link rel="stylesheet" href="http://jijeshmohan.github.io//css/redlounge.css">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
  <link href='//fonts.googleapis.com/css?family=Raleway:400,200,100,700,300,500,600,800' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Libre+Baskerville:400,700,400italic' rel='stylesheet' type='text/css'>

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://jijeshmohan.github.io/touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="http://jijeshmohan.github.io/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="Parthenon" />

    
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/solarized_light.min.css">
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  

  

  
</head>

<body>
	

	<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
  <div class="header">
    

    <h1 class="brand-title">Parthenon</h1>
    <h2 class="brand-tagline">learnings and thoughts about programming</h2>

    <nav class="nav">
      <ul class="nav-list">
        <li class="nav-item"><span class="nav-item-separator">//</span><a href="http://jijeshmohan.github.io/">Home</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="http://jijeshmohan.github.io/about/">About</a></li>
        
      </ul>
    </nav>

    
    <div class="social-buttons">
      
        
        <a href="https://www.twitter.com/jijeshmohan" target="_blank"><i class='fa fa-twitter'></i></a>
        
      
        
        <a href="https://github.com/jijeshmohan" target="_blank"><i class='fa fa-github'></i></a>
        
      

    </div>
    

  </div>
</div>

	
	

    <div class="content pure-u-1 pure-u-md-3-4">
		<a name="top"></a>
		

		
			
	    
  		<section class="post">
            <h1 class="post-title">
              <a href="http://jijeshmohan.github.io/post/gorillamux">Gorilla mux - Issue with order of routes</a>
            </h1>
            <h3 class="post-subtitle">
            	
            </h3>
            
            	<span class="post-date">
                	<span class="post-date-day"><sup>24</sup></span><span class="post-date-separator">/</span><span class="post-date-month">Mar</span> <span class="post-date-year">2015</span>
            	</span>
            	
            
            	
            

			
			
				<div class="post-categories">
				
					<a class="post-category post-category-golang" href="http://jijeshmohan.github.io//categories/golang">Golang</a>
				
				</div>
			

			

			

            <p><a href="gorillatoolkit.org">Gorilla toolkit</a> is one of the favorite http multiplexer library of gophers. I have been using the gorilla mux for quite sometime for micro services.
Mux allows you to define both static and dynamic routes.</p>

<p>Gorilla mux allows you to add similar routes unlike other multiplexer libraries like http-router. Consider the following scenario</p>

<pre><code class="language-go">router.Handle(&quot;/user/{name}&quot;,userHandle)
router.Handle(&quot;/user/admin&quot;,adminHandle)
</code></pre>

<p>When you hit <code>/user/user1</code> as expected <code>userHandle</code> function will be called.
But where as in the case of <code>/user/admin</code> the <code>userHandle</code> will be called instead of <code>adminHandle</code>. This means the order of routes matter. Whichever route matches first, will be called by gorilla mux.</p>

<p>One way to fix this issue is to change the order of routes in the above code. This is easy when you have very less number of routes but will become very tedious when the number of routes increases.</p>

<p>There is another way to handle this issue is to sort the routes depends on the length of the path and also ensure that static routes comes before dynamic routes.</p>

<p>Implement <a href="https://golang.org/src/sort/sort.go#12">sort</a> interface of golang for the endpoints and sort it before adding it to mux router. You can find the implementation  <a href="https://github.com/jijeshmohan/janus/blob/master/rest/endpoint.go">here</a>.</p>

	
			

			

			
				<div class="paging">
					<span class="paging-label">More Reading</span>
					

					
					<div class="paging-older">
						<span class="dark-red">Older</span><span class="decorative-marker">//</span>
			            <a class="paging-link" href="http://jijeshmohan.github.io/post/redcukes">Redcukes</a>
		            </div>
		            
	            </div>
            
          </section>
          
          	<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'jijeshmohan.github.io';
    var disqus_identifier = 'http:\/\/jijeshmohan.github.io\/post\/gorillamux\/';
    var disqus_title = 'Gorilla mux - Issue with order of routes';
    var disqus_url = 'http:\/\/jijeshmohan.github.io\/post\/gorillamux\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
          
        
      <div class="footer">
	<hr class="thin" />
	<div class="pure-menu pure-menu-horizontal pure-menu-open">
		<ul class="footer-menu">
		
		</ul>
	</div>

	<p>&copy; 2015. All rights reserved. </p>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63015273-1', 'auto');
  ga('send', 'pageview');

</script>
    </div>
  </div>
	

	

  
</body>
</html>